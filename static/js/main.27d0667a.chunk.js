(this["webpackJsonptic-tac-toe"]=this["webpackJsonptic-tac-toe"]||[]).push([[0],[,,,,,,,,,,,function(e,n,t){e.exports={wrapper:"field_wrapper__3o3Lx",prob:"field_prob__3P2p1",symbol:"field_symbol__2gvGQ",visible:"field_visible__2g4ms",cross:"field_cross__2N0lE",circle:"field_circle__349o7",button:"field_button__2apta"}},,,function(e,n,t){e.exports={wrapper:"board_wrapper__3KKpo",inner:"board_inner__2VoOT",draw:"board_draw__1Rb3n",item:"board_item__ZSKiR",highlighted:"board_highlighted__3hlOY"}},,,,,,,,,,,function(e,n,t){e.exports={wrapper:"app_wrapper__337D_",nav:"app_nav__3aflD"}},function(e,n,t){e.exports={wrapper:"console_wrapper__2dr62",symbol:"console_symbol__3ZSF-"}},,,,,,,function(e,n,t){e.exports=t.p+"static/media/cross.d4c64c18.svg"},function(e,n,t){e.exports=t.p+"static/media/circle.0f253cf1.svg"},,function(e,n,t){e.exports=t(58)},,,,,function(e,n,t){},,,,,,,function(e,n){},function(e,n){},function(e,n){},function(e,n){},function(e,n){},function(e,n){},,,,,function(e,n,t){"use strict";t.r(n);var a,r=t(1),i=t.n(r),c=t(32),u=t.n(c),o=(t(41),t(22)),l=t(4),s=t(25),f=t.n(s),p=t(3),d=t.n(p),m=t(6),v=t(2),b=t(21);function h(e){var n=function(n,t){var a=n,r=n+t,i=n+2*t;return 0!==e[a]&&e[a]===e[r]&&e[a]===e[i]&&[a,r,i]};return n(0,1)||n(3,1)||n(6,1)||n(0,3)||n(1,3)||n(2,3)||n(0,4)||n(2,2)}!function(e){e[e.Empty=0]="Empty",e[e.Cross=1]="Cross",e[e.Circle=-1]="Circle"}(a||(a={}));var E={fields:new Array(9).fill(a.Empty),turn:0};function w(e,n,t){return y.apply(this,arguments)}function y(){return(y=Object(m.a)(d.a.mark((function e(n,t,r){var i,c,u,o,l,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=function(){return(l=Object(m.a)(d.a.mark((function e(){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i.turn<9)){e.next=8;break}return e.next=3,c();case 3:if(!(n=h(i.fields))){e.next=6;break}return e.abrupt("return",{winner:{id:i.fields[n[0]],fields:n}});case 6:e.next=0;break;case 8:return e.abrupt("return",{winner:null});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)},o=function(){return l.apply(this,arguments)},u=function(){return(u=Object(m.a)(d.a.mark((function e(){var c,u,o,l,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=i.turn%2,o=(u=0===c)?a.Cross:a.Circle,l=(u?n:t).play,e.next=6,l(c?i.fields.map((function(e){return-e})):i.fields,c);case 6:if(s=e.sent,i.fields[s]===a.Empty){e.next=9;break}throw Error("Illegal move");case 9:(i={fields:Object(b.a)(i.fields),turn:i.turn+1}).fields[s]=o,r&&r(i);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)},c=function(){return u.apply(this,arguments)},i=E,e.next=7,o();case 7:if(s=e.sent,!n.onFinish){e.next=11;break}return e.next=11,n.onFinish(s,!!s.winner&&0===s.winner.id);case 11:if(!t.onFinish){e.next=14;break}return e.next=14,t.onFinish(s,!!s.winner&&1===s.winner.id);case 14:return e.abrupt("return",s);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=t(17),g=t.n(x),_=t(26),k=t.n(_),j=t(33),S=t.n(j),C=t(34),O=t.n(C),F=function(e){var n=e.src;return i.a.createElement("img",{alt:"Winning symbol",src:n,className:k.a.symbol})};function R(e){var n=e.winner;return n?i.a.createElement(i.a.Fragment,null,function(e){switch(e){case a.Cross:return i.a.createElement(F,{src:S.a});case a.Circle:return i.a.createElement(F,{src:O.a})}}(n.id),"\xa0","won!"):"It's a draw!"}var N=function(){var e=i.a.useState(null),n=Object(v.a)(e,2),t=n[0],a=n[1],r=z(),c=Q(),u=K(),o=i.a.useState(null),l=Object(v.a)(o,2),s=l[0],f=l[1];return i.a.useEffect((function(){c===D.Ready&&a(null)}),[c]),i.a.useEffect((function(){r&&a(R(r))}),[r]),i.a.useEffect((function(){if(!u)return s&&(clearTimeout(s),f(null)),void a(null);if(!s){var e=setTimeout((function(){a("Make your move!")}),5e3);return f(e),function(){return clearTimeout(e)}}}),[u,s]),i.a.createElement("div",{className:k.a.wrapper},t)},A=t(14),T=t.n(A),I=t(11),P=t.n(I);function M(e){switch(e){case a.Cross:return P.a.cross;case a.Circle:return P.a.circle;default:return null}}var D,L=function(e){var n,t=e.id,r=e.state,c=K(),u=V(),o=q(),l=i.a.createElement("div",{className:P.a.wrapper},i.a.createElement("div",{className:g()(P.a.symbol,r!==a.Empty&&P.a.visible,M(r)||(n=u.turn,n%2?P.a.circle:P.a.cross))}),o&&i.a.createElement("div",{className:P.a.prob},o[t].toFixed(2)));return c&&0===r?i.a.createElement("button",{className:P.a.button,onClick:function(){null===c||void 0===c||c.doAction(t)}},l):l},B=function(){var e=V().fields,n=z();return i.a.createElement("div",{className:T.a.wrapper},i.a.createElement("div",{className:g()(T.a.inner,n&&!n.winner&&T.a.draw)},e.map((function(e,t){return i.a.createElement("div",{className:g()(T.a.item,n&&n.winner&&n.winner.fields.includes(t)&&T.a.highlighted),key:t},i.a.createElement(L,{id:t,state:e}))}))),i.a.createElement(N,null))};!function(e){e[e.Loading=0]="Loading",e[e.Ready=1]="Ready",e[e.Running=2]="Running",e[e.Finished=3]="Finished"}(D||(D={}));var H=i.a.createContext(null),K=function(){return i.a.useContext(H)},W=i.a.createContext(null),q=function(){return i.a.useContext(W)},J=i.a.createContext(E),V=function(){return i.a.useContext(J)},Z=i.a.createContext(null),z=function(){return i.a.useContext(Z)},G=i.a.createContext(D.Loading),Q=function(){return i.a.useContext(G)},Y=function(e){var n=e.id,t=e.player0,a=e.player1,r=e.onFinish,c=i.a.useState(D.Loading),u=Object(v.a)(c,2),o=u[0],l=u[1],s=i.a.useState(E),f=Object(v.a)(s,2),p=f[0],b=f[1],h=i.a.useState(null),y=Object(v.a)(h,2),x=y[0],g=y[1];return i.a.useEffect((function(){function e(){return(e=Object(m.a)(d.a.mark((function e(){var i,c,u,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(D.Running),b(E),g(null),i=Math.random()<.5,c=i?a.player:t.player,u=i?t.player:a.player,e.next=8,w(c,u,b);case 8:o=e.sent,g(o),l(D.Finished),r&&r(n,o.winner&&(o.winner.id?u:c));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}o===D.Ready&&function(){e.apply(this,arguments)}()}),[n,o,t.player,a.player,r]),i.a.useEffect((function(){t.player&&a.player&&l(D.Ready)}),[n,t.player,a.player]),i.a.createElement(G.Provider,{value:o},i.a.createElement(J.Provider,{value:p},i.a.createElement(H.Provider,{value:(null===t||void 0===t?void 0:t.controller)||(null===a||void 0===a?void 0:a.controller)||null},i.a.createElement(W.Provider,{value:(null===t||void 0===t?void 0:t.probabilities)||(null===a||void 0===a?void 0:a.probabilities)||null},i.a.createElement(Z.Provider,{value:x},i.a.createElement(B,null))))))};function $(){var e=i.a.useState(null),n=Object(v.a)(e,2),t=n[0],a=n[1],r=i.a.useState(null),c=Object(v.a)(r,2),u=c[0],o=c[1];return i.a.useEffect((function(){a({play:function(e,n){return new Promise((function(e){o({id:n,doAction:function(n){o(null),e(n)}})}))}})}),[]),{controller:u,player:t}}var U=function(e){var n=e.children,t=e.pauseDuration,a=i.a.useState(0),r=Object(v.a)(a,2),c=r[0],u=r[1],o=i.a.useState(0),l=Object(v.a)(o,2),s=l[0],f=l[1],p=i.a.useCallback((function(e){u(e+1)}),[]);return i.a.useEffect((function(){if(c!==s){if(0!==t){var e=setTimeout((function(){return f(c)}),t||1e3);return function(){return clearTimeout(e)}}f(c)}}),[s,c,t]),i.a.createElement(i.a.Fragment,null,i.a.Children.map(n,(function(e,n){return i.a.isValidElement(e)&&i.a.cloneElement(e,{id:s,onFinish:p,key:n})})))},X=function(){var e=$(),n=$();return i.a.createElement(U,null,i.a.createElement(Y,{id:0,player0:e,player1:n}))},ee=t(10),ne="".concat("/tic-tac-toe","/static/ml/model.json"),te=function(){return ee.b(ne)};function ae(){var e=ee.c({layers:[ee.a.dense({inputShape:[9],units:32,activation:"relu"}),ee.a.dense({units:9})]});return e.summary(),e.compile({optimizer:ee.h.adam(),loss:"meanSquaredError"}),e}function re(e){return ie.apply(this,arguments)}function ie(){return(ie=Object(m.a)(d.a.mark((function e(n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=10;break}return e.prev=1,e.next=4,te();case 4:n=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),n=ae();case 10:return e.abrupt("return",{predict:function(e){return Object(m.a)(d.a.mark((function t(){var a,r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=ee.g((function(){var t=ee.f([e]),a=n.predict(t),r=Array.isArray(a)?a[0]:a;return ee.d(r)})),t.next=3,a.data();case 3:return r=t.sent,a.dispose(),t.abrupt("return",Array.from(r));case 6:case"end":return t.stop()}}),t)})))()},train:function(e,t){return Object(m.a)(d.a.mark((function a(){var r,i;return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=ee.e(e,[e.length,9]),i=ee.e(t,[t.length,9]),a.next=4,n.fit(r,i);case 4:r.dispose(),i.dispose();case 6:case"end":return a.stop()}}),a)})))()},download:function(){return n.save("downloads://model")}});case 11:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}var ce=new Array(9).fill(0);var ue=function(){var e=$(),n=function(e){var n=i.a.useState(null),t=Object(v.a)(n,2),r=t[0],c=t[1],u=i.a.useState(ce),o=Object(v.a)(u,2),l=o[0],s=o[1];return i.a.useEffect((function(){re().then((function(e){c({play:function(n){return Object(m.a)(d.a.mark((function t(){var r,i,c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.predict(n);case 2:r=t.sent,s(r),i=Array.from(r.keys()).sort((function(e,n){return r[n]-r[e]}));case 5:if(!i.length){t.next=11;break}if(c=i.shift(),n[c]!==a.Empty){t.next=9;break}return t.abrupt("return",c);case 9:t.next=5;break;case 11:throw Error("Action prediction failed");case 12:case"end":return t.stop()}}),t)})))()}})}))}),[]),i.a.useEffect((function(){s(ce)}),[e]),{player:r,probabilities:l}}();return i.a.createElement(U,{pauseDuration:2e3},i.a.createElement(Y,{id:0,player0:e,player1:n}))};function oe(e){for(var n=e.length-1;n>0;n--){var t=Math.floor(Math.random()*(n+1)),a=[e[t],e[n]];e[n]=a[0],e[t]=a[1]}}var le;!function(e){e[e.Idle=0]="Idle",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"}(le||(le={}));var se=function(){var e=i.a.useState(null),n=Object(v.a)(e,2),t=n[0],a=n[1],r=i.a.useState(0),c=Object(v.a)(r,2),u=c[0],o=c[1],l=i.a.useState(null),s=Object(v.a)(l,2),f=s[0],p=s[1];return i.a.useEffect((function(){if(!t){var e=!0;return fetch("".concat("/tic-tac-toe","/static/ml/data.json")).then((function(e){return e.json()})).then((function(n){e&&a(n)})),function(){e=!1}}}),[t]),i.a.useEffect((function(){if(f&&f.getState()===le.Idle)return f.start().then((function(){f.getState()!==le.Stopped&&(p(null),o(0))})),function(){return f.stop()}}),[f]),i.a.createElement(i.a.Fragment,null,t?i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,"Training on labeled dataset:",i.a.createElement("br",null),i.a.createElement("strong",null,t.length)," unique game states"),i.a.createElement("p",null,i.a.createElement("button",{onClick:function(){t&&p(function(e,n){var t=le.Idle;function a(e){t=e}function r(){return(r=Object(m.a)(d.a.mark((function a(){var r,i,c,u,o;return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t=le.Running,e(0),a.next=4,re(ae());case 4:r=a.sent,i=0;case 6:if(!(i<512)){a.next=19;break}return oe(c=Object(b.a)(n)),u=c.map((function(e){return Object(v.a)(e,1)[0]})),o=c.map((function(e){return Object(v.a)(e,2)[1]})),a.next=13,r.train(u,o);case 13:if(t!==le.Stopped){a.next=15;break}return a.abrupt("return");case 15:e(i+1);case 16:i++,a.next=6;break;case 19:return a.next=21,r.download();case 21:case"end":return a.stop()}}),a)})))).apply(this,arguments)}return{start:function(){return r.apply(this,arguments)},stop:function(){a(le.Stopped)},getState:function(){return t},setState:a}}(o,t))},disabled:!!f},"Train and download model")),u>0&&i.a.createElement("p",null,"Batches learned: ",u," / ",512," (",Math.round(u/512*100),"%)"),!!f&&f.getState()===le.Running&&i.a.createElement("p",null,i.a.createElement("button",{onClick:function(){f.stop(),p(null),o(0)}},"Stop training"))):i.a.createElement("p",null,"Downloading training data..."))},fe=function(){var e=[{path:"/pva",Component:ue,title:"Human vs AI"},{path:"/pvp",Component:X,title:"Human vs Human"},{path:"/training",Component:se,title:"Training"}];return i.a.createElement("div",{className:f.a.wrapper},i.a.createElement(o.a,null,i.a.createElement("h1",null,i.a.createElement(o.b,{to:"/"},"tic tac toe")),i.a.createElement("nav",{className:f.a.nav},e.map((function(e,n){var t=e.path,a=e.title;return i.a.createElement(o.b,{to:t,key:n},a)}))),i.a.createElement(l.c,null,i.a.createElement(l.a,{path:"/",exact:!0},i.a.createElement(X,null)),e.map((function(e,n){var t=e.path,a=e.Component,r=e.title;return i.a.createElement(l.a,{path:t,key:n},i.a.createElement("h2",null,r),i.a.createElement(a,null))})),i.a.createElement(l.a,null,i.a.createElement("h2",null,"404"),i.a.createElement("p",null,"Page not found. :(")))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(fe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[36,1,2]]]);
//# sourceMappingURL=main.27d0667a.chunk.js.map