(this["webpackJsonptic-tac-toe"]=this["webpackJsonptic-tac-toe"]||[]).push([[0],[,,,,,,,,,,,function(e,t,n){e.exports={wrapper:"field_wrapper__3o3Lx",prob:"field_prob__3P2p1",symbol:"field_symbol__2gvGQ",visible:"field_visible__2g4ms",cross:"field_cross__2N0lE",circle:"field_circle__349o7",button:"field_button__2apta"}},,,,function(e,t,n){e.exports={wrapper:"app_wrapper__337D_",inner:"app_inner__3X00H",nav:"app_nav__3aflD",activeLink:"app_activeLink__3p8fE",signature:"app_signature__3JUHD"}},function(e,t,n){e.exports={wrapper:"board_wrapper__3KKpo",inner:"board_inner__2VoOT",draw:"board_draw__1Rb3n",item:"board_item__ZSKiR",highlighted:"board_highlighted__3hlOY"}},,,,,,,,,,function(e,t,n){e.exports={wrapper:"console_wrapper__2dr62",symbol:"console_symbol__3ZSF-"}},,,,,,,function(e,t,n){e.exports=n.p+"static/media/cross.d4c64c18.svg"},function(e,t,n){e.exports=n.p+"static/media/circle.0f253cf1.svg"},function(e,t,n){e.exports={link:"gh-link_link___8rbM"}},function(e,t,n){e.exports=n.p+"static/media/github.5cff78e4.svg"},,function(e,t,n){e.exports=n(60)},,,,,function(e,t,n){},,,,,,,function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},,,,,function(e,t,n){"use strict";n.r(t);var a,r=n(1),i=n.n(r),c=n(32),o=n.n(c),u=(n(43),n(4)),l=n(13),s=n(15),f=n.n(s),p=n(3),m=n.n(p),d=n(6),v=n(2),h=n(23);function b(e){var t=function(t,n){var a=t,r=t+n,i=t+2*n;return 0!==e[a]&&e[a]===e[r]&&e[a]===e[i]&&[a,r,i]};return t(0,1)||t(3,1)||t(6,1)||t(0,3)||t(1,3)||t(2,3)||t(0,4)||t(2,2)}!function(e){e[e.Empty=0]="Empty",e[e.Cross=1]="Cross",e[e.Circle=-1]="Circle"}(a||(a={}));var E={fields:new Array(9).fill(a.Empty),turn:0};function g(e,t,n){return w.apply(this,arguments)}function w(){return(w=Object(d.a)(m.a.mark((function e(t,n,r){var i,c,o,u,l,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=function(){return(l=Object(d.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i.turn<9)){e.next=8;break}return e.next=3,c();case 3:if(!(t=b(i.fields))){e.next=6;break}return e.abrupt("return",{winner:{id:i.fields[t[0]],fields:t}});case 6:e.next=0;break;case 8:return e.abrupt("return",{winner:null});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)},u=function(){return l.apply(this,arguments)},o=function(){return(o=Object(d.a)(m.a.mark((function e(){var c,o,u,l,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=i.turn%2,u=(o=0===c)?a.Cross:a.Circle,l=(o?t:n).play,e.next=6,l(c?i.fields.map((function(e){return-e})):i.fields,c);case 6:if(s=e.sent,i.fields[s]===a.Empty){e.next=9;break}throw Error("Illegal move");case 9:(i={fields:Object(h.a)(i.fields),turn:i.turn+1}).fields[s]=u,r&&r(i);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)},c=function(){return o.apply(this,arguments)},i=E,e.next=7,u();case 7:if(s=e.sent,!t.onFinish){e.next=11;break}return e.next=11,t.onFinish(s,!!s.winner&&0===s.winner.id);case 11:if(!n.onFinish){e.next=14;break}return e.next=14,n.onFinish(s,!!s.winner&&1===s.winner.id);case 14:return e.abrupt("return",s);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=n(19),_=n.n(y),x=n(26),k=n.n(x),j=n(33),O=n.n(j),S=n(34),C=n.n(S),N=function(e){var t=e.src;return i.a.createElement("img",{alt:"Winning symbol",src:t,className:k.a.symbol})};function F(e){var t=e.winner;return t?i.a.createElement(i.a.Fragment,null,function(e){switch(e){case a.Cross:return i.a.createElement(N,{src:O.a});case a.Circle:return i.a.createElement(N,{src:C.a})}}(t.id),"\xa0","won!"):"It's a draw!"}var R=function(){var e=i.a.useState(null),t=Object(v.a)(e,2),n=t[0],a=t[1],r=Y(),c=z(),o=B(),u=i.a.useState(null),l=Object(v.a)(u,2),s=l[0],f=l[1];return i.a.useEffect((function(){c===M.Ready&&a(null)}),[c]),i.a.useEffect((function(){r&&a(F(r))}),[r]),i.a.useEffect((function(){if(!o)return s&&(clearTimeout(s),f(null)),void a(null);if(!s){var e=setTimeout((function(){a("Make your move!")}),5e3);return f(e),function(){return clearTimeout(e)}}}),[o,s]),i.a.createElement("div",{className:k.a.wrapper},n)},A=n(16),T=n.n(A),I=n(11),P=n.n(I);function L(e){switch(e){case a.Cross:return P.a.cross;case a.Circle:return P.a.circle;default:return null}}var M,D=function(e){var t,n=e.id,r=e.state,c=B(),o=G(),u=J(),l=i.a.createElement("div",{className:P.a.wrapper},i.a.createElement("div",{className:_()(P.a.symbol,r!==a.Empty&&P.a.visible,L(r)||(t=o.turn,t%2?P.a.circle:P.a.cross))}),u&&i.a.createElement("div",{className:P.a.prob},u[n].toFixed(2)));return c&&0===r?i.a.createElement("button",{className:P.a.button,onClick:function(){null===c||void 0===c||c.doAction(n)}},l):l},K=function(){var e=G().fields,t=Y();return i.a.createElement("div",{className:T.a.wrapper},i.a.createElement("div",{className:_()(T.a.inner,t&&!t.winner&&T.a.draw)},e.map((function(e,n){return i.a.createElement("div",{className:_()(T.a.item,t&&t.winner&&t.winner.fields.includes(n)&&T.a.highlighted),key:n},i.a.createElement(D,{id:n,state:e}))}))),i.a.createElement(R,null))};!function(e){e[e.Loading=0]="Loading",e[e.Ready=1]="Ready",e[e.Running=2]="Running",e[e.Finished=3]="Finished"}(M||(M={}));var W=i.a.createContext(null),B=function(){return i.a.useContext(W)},H=i.a.createContext(null),J=function(){return i.a.useContext(H)},q=i.a.createContext(E),G=function(){return i.a.useContext(q)},V=i.a.createContext(null),Y=function(){return i.a.useContext(V)},Z=i.a.createContext(M.Loading),z=function(){return i.a.useContext(Z)},Q=function(e){var t=e.id,n=e.player0,a=e.player1,r=e.onFinish,c=i.a.useState(M.Loading),o=Object(v.a)(c,2),u=o[0],l=o[1],s=i.a.useState(E),f=Object(v.a)(s,2),p=f[0],h=f[1],b=i.a.useState(null),w=Object(v.a)(b,2),y=w[0],_=w[1];return i.a.useEffect((function(){function e(){return(e=Object(d.a)(m.a.mark((function e(){var i,c,o,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(M.Running),h(E),_(null),i=Math.random()<.5,c=i?a.player:n.player,o=i?n.player:a.player,e.next=8,g(c,o,h);case 8:u=e.sent,_(u),l(M.Finished),r&&r(t,u.winner&&(u.winner.id?o:c));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}u===M.Ready&&function(){e.apply(this,arguments)}()}),[t,u,n.player,a.player,r]),i.a.useEffect((function(){n.player&&a.player&&l(M.Ready)}),[t,n.player,a.player]),i.a.createElement(Z.Provider,{value:u},i.a.createElement(q.Provider,{value:p},i.a.createElement(W.Provider,{value:(null===n||void 0===n?void 0:n.controller)||(null===a||void 0===a?void 0:a.controller)||null},i.a.createElement(H.Provider,{value:(null===n||void 0===n?void 0:n.probabilities)||(null===a||void 0===a?void 0:a.probabilities)||null},i.a.createElement(V.Provider,{value:y},i.a.createElement(K,null))))))};function U(){var e=i.a.useState(null),t=Object(v.a)(e,2),n=t[0],a=t[1],r=i.a.useState(null),c=Object(v.a)(r,2),o=c[0],u=c[1];return i.a.useEffect((function(){a({play:function(e,t){return new Promise((function(e){u({id:t,doAction:function(t){u(null),e(t)}})}))}})}),[]),{controller:o,player:n}}var X=function(e){var t=e.children,n=e.pauseDuration,a=i.a.useState(0),r=Object(v.a)(a,2),c=r[0],o=r[1],u=i.a.useState(0),l=Object(v.a)(u,2),s=l[0],f=l[1],p=i.a.useCallback((function(e){o(e+1)}),[]);return i.a.useEffect((function(){if(c!==s){if(0!==n){var e=setTimeout((function(){return f(c)}),n||1e3);return function(){return clearTimeout(e)}}f(c)}}),[s,c,n]),i.a.createElement(i.a.Fragment,null,i.a.Children.map(t,(function(e,t){return i.a.isValidElement(e)&&i.a.cloneElement(e,{id:s,onFinish:p,key:t})})))},$=function(){var e=U(),t=U();return i.a.createElement(X,null,i.a.createElement(Q,{id:0,player0:e,player1:t}))},ee=n(10),te="".concat("/tic-tac-toe","/static/ml/model.json"),ne=function(){return ee.b(te)};function ae(){var e=ee.c({layers:[ee.a.dense({inputShape:[9],units:64,activation:"relu"}),ee.a.dense({units:9})]});return e.summary(),e.compile({optimizer:ee.h.adam(),loss:"meanSquaredError"}),e}function re(e){return ie.apply(this,arguments)}function ie(){return(ie=Object(d.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=10;break}return e.prev=1,e.next=4,ne();case 4:t=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),t=ae();case 10:return e.abrupt("return",{predict:function(e){return Object(d.a)(m.a.mark((function n(){var a,r;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=ee.g((function(){var n=ee.f([e]),a=t.predict(n),r=Array.isArray(a)?a[0]:a;return ee.d(r)})),n.next=3,a.data();case 3:return r=n.sent,a.dispose(),n.abrupt("return",Array.from(r));case 6:case"end":return n.stop()}}),n)})))()},train:function(e,n){return Object(d.a)(m.a.mark((function a(){var r,i;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=ee.e(e,[e.length,9]),i=ee.e(n,[n.length,9]),a.next=4,t.fit(r,i);case 4:r.dispose(),i.dispose();case 6:case"end":return a.stop()}}),a)})))()},download:function(){return t.save("downloads://model")}});case 11:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}var ce=new Array(9).fill(0);var oe=function(){var e=U(),t=function(e){var t=i.a.useState(null),n=Object(v.a)(t,2),r=n[0],c=n[1],o=i.a.useState(ce),u=Object(v.a)(o,2),l=u[0],s=u[1];return i.a.useEffect((function(){re().then((function(e){c({play:function(t){return Object(d.a)(m.a.mark((function n(){var r,i,c;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.predict(t);case 2:r=n.sent,s(r),i=Array.from(r.keys()).sort((function(e,t){return r[t]-r[e]}));case 5:if(!i.length){n.next=11;break}if(c=i.shift(),t[c]!==a.Empty){n.next=9;break}return n.abrupt("return",c);case 9:n.next=5;break;case 11:throw Error("Action prediction failed");case 12:case"end":return n.stop()}}),n)})))()}})}))}),[]),i.a.useEffect((function(){s(ce)}),[e]),{player:r,probabilities:l}}();return i.a.createElement(X,{pauseDuration:2e3},i.a.createElement(Q,{id:0,player0:e,player1:t}))};function ue(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),a=[e[n],e[t]];e[t]=a[0],e[n]=a[1]}}var le;!function(e){e[e.Idle=0]="Idle",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"}(le||(le={}));var se=function(){var e=i.a.useState(null),t=Object(v.a)(e,2),n=t[0],a=t[1],r=i.a.useState(0),c=Object(v.a)(r,2),o=c[0],u=c[1],l=i.a.useState(null),s=Object(v.a)(l,2),f=s[0],p=s[1];return i.a.useEffect((function(){if(!n){var e=!0;return fetch("".concat("/tic-tac-toe","/static/ml/data.json")).then((function(e){return e.json()})).then((function(t){e&&a(t)})),function(){e=!1}}}),[n]),i.a.useEffect((function(){if(f&&f.getState()===le.Idle)return f.start().then((function(){f.getState()!==le.Stopped&&(p(null),u(0))})),function(){return f.stop()}}),[f]),i.a.createElement(i.a.Fragment,null,n?i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,"Training on labeled dataset:",i.a.createElement("br",null),i.a.createElement("strong",null,n.length)," unique game states"),i.a.createElement("p",null,i.a.createElement("button",{onClick:function(){n&&p(function(e,t){var n=le.Idle;function a(e){n=e}function r(){return(r=Object(d.a)(m.a.mark((function a(){var r,i,c,o,u;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=le.Running,e(0),a.next=4,re(ae());case 4:r=a.sent,i=0;case 6:if(!(i<512)){a.next=19;break}return ue(c=Object(h.a)(t)),o=c.map((function(e){return Object(v.a)(e,1)[0]})),u=c.map((function(e){return Object(v.a)(e,2)[1]})),a.next=13,r.train(o,u);case 13:if(n!==le.Stopped){a.next=15;break}return a.abrupt("return");case 15:e(i+1);case 16:i++,a.next=6;break;case 19:return a.next=21,r.download();case 21:case"end":return a.stop()}}),a)})))).apply(this,arguments)}return{start:function(){return r.apply(this,arguments)},stop:function(){a(le.Stopped)},getState:function(){return n},setState:a}}(u,n))},disabled:!!f},"Train and download model")),o>0&&i.a.createElement("p",null,"Batches learned: ",o," / ",512," (",Math.round(o/512*100),"%)"),!!f&&f.getState()===le.Running&&i.a.createElement("p",null,i.a.createElement("button",{onClick:function(){f.stop(),p(null),u(0)}},"Stop training"))):i.a.createElement("p",null,"Downloading training data..."))},fe=n(35),pe=n.n(fe),me=n(36),de=n.n(me),ve=function(){return i.a.createElement("a",{href:"https://github.com/paulkre/tic-tac-toe",target:"_blank",rel:"noopener noreferrer",className:pe.a.link},i.a.createElement("img",{src:de.a,alt:"GitHub icon"}))},he=function(e){var t=e.pages,n=Object(u.f)().pathname;return i.a.createElement("nav",{className:f.a.nav},t.map((function(e,t){var a=e.path,r=e.title;return i.a.createElement(l.b,{to:a,className:n===a?f.a.activeLink:void 0,key:t},r)})))},be=function(){var e=[{path:"/pvp",Component:$,title:"Against Yourself"},{path:"/pva",Component:oe,title:"Against AI"},{path:"/training",Component:se,title:"Training"}];return i.a.createElement("div",{className:f.a.wrapper},i.a.createElement("div",{className:f.a.inner},i.a.createElement(l.a,{basename:"/tic-tac-toe"},i.a.createElement("h1",null,i.a.createElement(l.b,{to:"/"},"tic tac toe")),i.a.createElement(he,{pages:e}),i.a.createElement(u.c,null,i.a.createElement(u.a,{path:"/",exact:!0},i.a.createElement("p",null,"Welcome to my little tic tac toe game. The purpose of this project was to get familiar with the development of machine learning algorithms in tensorflow.js. On this website you can either play against ",i.a.createElement(l.b,{to:"/pvp"},"yourself")," or against a very simple machine learning ",i.a.createElement(l.b,{to:"/pva"},"algorithm"),". If you want, you can even ",i.a.createElement(l.b,{to:"/training"},"train")," your own tensorflow model and download it. The source code is available"," ",i.a.createElement("a",{href:"https://github.com/paulkre/tic-tac-toe",target:"_blank",rel:"noopener noreferrer"},"here"),"."),i.a.createElement("p",{className:f.a.signature},"\u2014",i.a.createElement("br",null),"Paul Kretschel")),e.map((function(e,t){var n=e.path,a=e.Component,r=e.title;return i.a.createElement(u.a,{path:n,key:t},i.a.createElement("h2",null,r),i.a.createElement(a,null))})),i.a.createElement(u.a,null,i.a.createElement("h2",null,"404"),i.a.createElement("p",null,"Page not found. :("))))),i.a.createElement(ve,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(be,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[38,1,2]]]);
//# sourceMappingURL=main.eb720509.chunk.js.map